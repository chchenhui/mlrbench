Starting experiment...
Loading and preparing dataset...
Data loading complete.

--- Running Zero-Shot CLIP ---
Zero-Shot Avg Accuracy: 0.7450
Zero-Shot Worst-Group Accuracy: 0.0588

--- Running Standard LoRA Fine-Tuning ---
LoRA Avg Accuracy: 0.3075
LoRA Worst-Group Accuracy: 0.0656

--- Running SCA-Adapter ---
SCA-Adapter trainable params: 201348 || all params: 86000772 || trainable%: 0.23412347972876338
Identifying spurious features with Grad-CAM...
SCA-Adapter Avg Accuracy: 0.7550
SCA-Adapter Worst-Group Accuracy: 0.0000

--- Generating Results ---
Results saved to ./gemini/outputs/results.json
WGA plot saved to ./results/wga_comparison.png
Avg Acc plot saved to ./results/avg_acc_comparison.png
Params plot saved to ./results/params_comparison.png
results.md generated at ./results/results.md
Experiment finished successfully.
