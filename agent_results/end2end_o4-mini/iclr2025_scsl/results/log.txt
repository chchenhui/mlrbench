2025-05-11 18:32:15,118 - __main__ - INFO - Generating synthetic dataset...
2025-05-11 18:32:16,525 - __main__ - INFO - Generated dataset with 1000 samples
2025-05-11 18:32:16,871 - __main__ - INFO - Creating shuffled dataset for channel: background
2025-05-11 18:32:17,162 - __main__ - INFO - Created shuffled dataset with 200 samples
2025-05-11 18:32:17,162 - __main__ - INFO - Creating shuffled dataset for channel: color
2025-05-11 18:32:17,444 - __main__ - INFO - Created shuffled dataset with 200 samples
2025-05-11 18:32:17,445 - __main__ - INFO - Creating shuffled dataset for channel: shape
2025-05-11 18:32:17,723 - __main__ - INFO - Created shuffled dataset with 200 samples
2025-05-11 18:32:17,724 - __main__ - INFO - Running experiments with modality: image
2025-05-11 18:32:17,724 - __main__ - INFO - Using device: cuda:0
2025-05-11 18:32:17,729 - __main__ - INFO - Starting experiment with method: erm
2025-05-11 18:32:18,080 - utils.training - INFO - Starting training for 3 epochs
2025-05-11 18:32:20,082 - utils.training - INFO - Epoch 1/3 - Train Loss: 1.1305, Train Acc: 0.5400, Val Loss: 2.7027, Val Acc: 0.5700
2025-05-11 18:32:20,275 - utils.training - INFO - Saved best model at epoch 1 with validation accuracy 0.5700
2025-05-11 18:32:21,417 - utils.training - INFO - Epoch 2/3 - Train Loss: 0.8961, Train Acc: 0.6567, Val Loss: 1.2902, Val Acc: 0.6700
2025-05-11 18:32:21,909 - utils.training - INFO - Saved best model at epoch 2 with validation accuracy 0.6700
2025-05-11 18:32:23,047 - utils.training - INFO - Epoch 3/3 - Train Loss: 0.8813, Train Acc: 0.6200, Val Loss: 0.9375, Val Acc: 0.6750
2025-05-11 18:32:23,533 - utils.training - INFO - Saved best model at epoch 3 with validation accuracy 0.6750
2025-05-11 18:32:23,533 - utils.training - INFO - Training completed in 5.45 seconds
2025-05-11 18:32:24,263 - utils.training - INFO - Test accuracy: 0.6500
2025-05-11 18:32:42,064 - __main__ - INFO - Generating synthetic dataset...
2025-05-11 18:32:42,785 - __main__ - INFO - Generated dataset with 500 samples
2025-05-11 18:32:43,139 - __main__ - INFO - Creating shuffled dataset for channel: background
2025-05-11 18:32:43,290 - __main__ - INFO - Created shuffled dataset with 100 samples
2025-05-11 18:32:43,290 - __main__ - INFO - Creating shuffled dataset for channel: color
2025-05-11 18:32:43,431 - __main__ - INFO - Created shuffled dataset with 100 samples
2025-05-11 18:32:43,431 - __main__ - INFO - Creating shuffled dataset for channel: shape
2025-05-11 18:32:43,572 - __main__ - INFO - Created shuffled dataset with 100 samples
2025-05-11 18:32:43,573 - __main__ - INFO - Running experiments with modality: image
2025-05-11 18:32:43,573 - __main__ - INFO - Using device: cuda:0
2025-05-11 18:32:43,576 - __main__ - INFO - Starting experiment with method: erm
2025-05-11 18:32:43,935 - utils.training - INFO - Starting training for 2 epochs
2025-05-11 18:32:45,507 - utils.training - INFO - Epoch 1/2 - Train Loss: 0.7060, Train Acc: 0.6733, Val Loss: 0.7111, Val Acc: 0.8600
2025-05-11 18:32:45,675 - utils.training - INFO - Saved best model at epoch 1 with validation accuracy 0.8600
2025-05-11 18:32:46,516 - utils.training - INFO - Epoch 2/2 - Train Loss: 0.4346, Train Acc: 0.8367, Val Loss: 0.8351, Val Acc: 0.8600
2025-05-11 18:32:46,516 - utils.training - INFO - Training completed in 2.58 seconds
2025-05-11 18:32:47,181 - utils.training - INFO - Test accuracy: 0.8900
2025-05-11 18:32:47,540 - utils.training - INFO - Worst-group accuracy: 0.0000
2025-05-11 18:32:48,313 - __main__ - INFO - Method: erm, Channel: background, Spurious Sensitivity Score: 0.2979
2025-05-11 18:32:48,758 - __main__ - INFO - Method: erm, Channel: color, Spurious Sensitivity Score: 0.3029
2025-05-11 18:32:49,206 - __main__ - INFO - Method: erm, Channel: shape, Spurious Sensitivity Score: 0.2211
2025-05-11 18:33:10,797 - __main__ - INFO - Generating synthetic dataset...
2025-05-11 18:33:11,232 - __main__ - INFO - Generated dataset with 300 samples
2025-05-11 18:33:11,576 - __main__ - INFO - Creating shuffled dataset for channel: background
2025-05-11 18:33:11,663 - __main__ - INFO - Created shuffled dataset with 60 samples
2025-05-11 18:33:11,663 - __main__ - INFO - Creating shuffled dataset for channel: color
2025-05-11 18:33:11,748 - __main__ - INFO - Created shuffled dataset with 60 samples
2025-05-11 18:33:11,748 - __main__ - INFO - Creating shuffled dataset for channel: shape
2025-05-11 18:33:11,835 - __main__ - INFO - Created shuffled dataset with 60 samples
2025-05-11 18:33:11,835 - __main__ - INFO - Running experiments with modality: image
2025-05-11 18:33:11,835 - __main__ - INFO - Using device: cuda:0
2025-05-11 18:33:11,839 - __main__ - INFO - Starting experiment with method: erm
2025-05-11 18:33:12,186 - utils.training - INFO - Starting training for 2 epochs
2025-05-11 18:33:13,587 - utils.training - INFO - Epoch 1/2 - Train Loss: 0.7250, Train Acc: 0.6889, Val Loss: 0.3570, Val Acc: 0.8333
2025-05-11 18:33:14,034 - utils.training - INFO - Saved best model at epoch 1 with validation accuracy 0.8333
2025-05-11 18:33:14,745 - utils.training - INFO - Epoch 2/2 - Train Loss: 0.4187, Train Acc: 0.8722, Val Loss: 0.5310, Val Acc: 0.9000
2025-05-11 18:33:15,218 - utils.training - INFO - Saved best model at epoch 2 with validation accuracy 0.9000
2025-05-11 18:33:15,219 - utils.training - INFO - Training completed in 3.03 seconds
2025-05-11 18:33:16,186 - utils.training - INFO - Test accuracy: 0.9333
2025-05-11 18:33:16,492 - utils.training - INFO - Worst-group accuracy: 0.0000
2025-05-11 18:33:17,213 - __main__ - INFO - Method: erm, Channel: background, Spurious Sensitivity Score: 0.4347
2025-05-11 18:33:17,631 - __main__ - INFO - Method: erm, Channel: color, Spurious Sensitivity Score: 0.3282
2025-05-11 18:33:18,035 - __main__ - INFO - Method: erm, Channel: shape, Spurious Sensitivity Score: 0.3227
2025-05-11 18:33:18,763 - __main__ - INFO - Method: erm, Invariance Gap: -2.2367
2025-05-11 18:33:18,864 - __main__ - INFO - Comparison of methods:
2025-05-11 18:33:18,864 - __main__ - INFO - Method          Test Acc   Worst Group     Avg SSS    IG        
2025-05-11 18:33:18,865 - __main__ - INFO - ------------------------------------------------------------
2025-05-11 18:33:18,865 - __main__ - INFO - erm             0.9333     0.0000          0.3619     -2.2367   
2025-05-11 18:33:19,003 - __main__ - INFO - Results saved to results/results.md
2025-05-11 18:33:19,003 - __main__ - INFO - Total experiment time: 8.21 seconds
2025-05-11 18:33:30,972 - __main__ - INFO - Running experiments with modality: image
2025-05-11 18:33:30,972 - __main__ - INFO - Using device: cuda:0
2025-05-11 18:33:30,975 - __main__ - INFO - Starting experiment with method: erm
2025-05-11 18:33:31,339 - utils.training - INFO - Starting training for 3 epochs
2025-05-11 18:33:32,723 - utils.training - INFO - Epoch 1/3 - Train Loss: 0.7250, Train Acc: 0.6889, Val Loss: 0.3570, Val Acc: 0.8333
2025-05-11 18:33:32,896 - utils.training - INFO - Saved best model at epoch 1 with validation accuracy 0.8333
2025-05-11 18:33:33,628 - utils.training - INFO - Epoch 2/3 - Train Loss: 0.4187, Train Acc: 0.8722, Val Loss: 0.5310, Val Acc: 0.9000
2025-05-11 18:33:34,072 - utils.training - INFO - Saved best model at epoch 2 with validation accuracy 0.9000
2025-05-11 18:33:34,815 - utils.training - INFO - Epoch 3/3 - Train Loss: 0.3426, Train Acc: 0.8778, Val Loss: 1.3009, Val Acc: 0.8833
2025-05-11 18:33:34,816 - utils.training - INFO - Training completed in 3.48 seconds
2025-05-11 18:33:35,439 - utils.training - INFO - Test accuracy: 0.9333
2025-05-11 18:33:35,748 - utils.training - INFO - Worst-group accuracy: 0.0000
2025-05-11 18:33:36,493 - __main__ - INFO - Method: erm, Channel: background, Spurious Sensitivity Score: 0.4347
2025-05-11 18:33:36,898 - __main__ - INFO - Method: erm, Channel: color, Spurious Sensitivity Score: 0.3282
2025-05-11 18:33:37,313 - __main__ - INFO - Method: erm, Channel: shape, Spurious Sensitivity Score: 0.3227
2025-05-11 18:33:38,023 - __main__ - INFO - Method: erm, Invariance Gap: -2.2367
2025-05-11 18:33:38,140 - __main__ - INFO - Starting experiment with method: irm
2025-05-11 18:33:38,332 - utils.training - INFO - Starting training for 3 epochs
2025-05-11 18:33:38,951 - utils.training - INFO - IRM Penalty: 0.0087, Penalty Weight: 0.0000
2025-05-11 18:33:39,255 - utils.training - INFO - Epoch 1/3 - Train Loss: 0.7169, Train Acc: 0.6833, Val Loss: 0.7323, Val Acc: 0.8333
2025-05-11 18:33:39,428 - utils.training - INFO - Saved best model at epoch 1 with validation accuracy 0.8333
2025-05-11 18:33:39,861 - utils.training - INFO - IRM Penalty: 0.0408, Penalty Weight: 0.0000
2025-05-11 18:33:40,150 - utils.training - INFO - Epoch 2/3 - Train Loss: 0.4487, Train Acc: 0.8778, Val Loss: 2.8983, Val Acc: 0.6000
2025-05-11 18:33:40,594 - utils.training - INFO - IRM Penalty: 0.0223, Penalty Weight: 0.0000
2025-05-11 18:33:40,872 - utils.training - INFO - Epoch 3/3 - Train Loss: 0.3548, Train Acc: 0.8778, Val Loss: 3.0519, Val Acc: 0.6333
2025-05-11 18:33:40,872 - utils.training - INFO - Training completed in 2.54 seconds
2025-05-11 18:33:41,491 - utils.training - INFO - Test accuracy: 0.8500
2025-05-11 18:33:41,809 - utils.training - INFO - Worst-group accuracy: 0.0000
2025-05-11 18:33:42,556 - __main__ - INFO - Method: irm, Channel: background, Spurious Sensitivity Score: 0.2928
2025-05-11 18:33:42,980 - __main__ - INFO - Method: irm, Channel: color, Spurious Sensitivity Score: 0.1987
2025-05-11 18:33:43,417 - __main__ - INFO - Method: irm, Channel: shape, Spurious Sensitivity Score: 0.4001
2025-05-11 18:33:44,133 - __main__ - INFO - Method: irm, Invariance Gap: -0.8038
2025-05-11 18:33:44,262 - __main__ - INFO - Comparison of methods:
2025-05-11 18:33:44,262 - __main__ - INFO - Method          Test Acc   Worst Group     Avg SSS    IG        
2025-05-11 18:33:44,262 - __main__ - INFO - ------------------------------------------------------------
2025-05-11 18:33:44,263 - __main__ - INFO - erm             0.9333     0.0000          0.3619     -2.2367   
2025-05-11 18:33:44,263 - __main__ - INFO - irm             0.8500     0.0000          0.2972     -0.8038   
2025-05-11 18:33:44,417 - __main__ - INFO - Results saved to results/results.md
2025-05-11 18:33:44,417 - __main__ - INFO - Total experiment time: 13.45 seconds
