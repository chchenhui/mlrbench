2025-05-10 09:33:24,213 - __main__ - INFO - Running all tests...
2025-05-10 09:33:24,213 - __main__ - INFO - Testing token relevance predictor...
2025-05-10 09:33:24,221 - __main__ - INFO - Token relevance predictor test passed!
2025-05-10 09:33:24,224 - __main__ - INFO - Testing attention statistics extractor...
2025-05-10 09:33:24,225 - __main__ - INFO - Attention statistics extractor test passed!
2025-05-10 09:33:24,225 - __main__ - INFO - Testing handcrafted feature extractor...
2025-05-10 09:33:24,226 - __main__ - INFO - Handcrafted feature extractor test passed!
2025-05-10 09:33:24,226 - __main__ - INFO - Testing relevance threshold controller...
2025-05-10 09:33:24,227 - __main__ - INFO - Threshold controller test passed!
2025-05-10 09:33:24,227 - __main__ - INFO - Testing KV cache factory...
2025-05-10 09:33:24,227 - __main__ - INFO - Creating full KV cache...
2025-05-10 09:33:24,227 - __main__ - INFO - full KV cache created successfully
2025-05-10 09:33:24,227 - __main__ - INFO - Creating sliding_window KV cache...
2025-05-10 09:33:24,227 - __main__ - INFO - sliding_window KV cache created successfully
2025-05-10 09:33:24,227 - __main__ - INFO - Creating dynamic_kv KV cache...
2025-05-10 09:33:24,227 - __main__ - INFO - dynamic_kv KV cache created successfully
2025-05-10 09:33:24,227 - __main__ - INFO - Creating rocket_kv KV cache...
2025-05-10 09:33:24,227 - __main__ - INFO - rocket_kv KV cache created successfully
2025-05-10 09:33:24,227 - __main__ - INFO - Creating atskv KV cache...
2025-05-10 09:33:24,462 - __main__ - ERROR - Error creating atskv KV cache: 'HandcraftedFeatureExtractor' object has no attribute 'to'
2025-05-10 09:33:24,462 - __main__ - INFO - Testing adaptive sparse KV cache...
2025-05-10 09:33:24,519 - __main__ - ERROR - Exception in test_sparse_kv_cache: 'HandcraftedFeatureExtractor' object has no attribute 'to'
2025-05-10 09:33:24,520 - __main__ - INFO - Testing integration with model: sshleifer/tiny-gpt2
2025-05-10 09:33:31,445 - __main__ - ERROR - Error in model integration test: 'HandcraftedFeatureExtractor' object has no attribute 'to'
2025-05-10 09:33:31,459 - __main__ - INFO - Test results summary:
2025-05-10 09:33:31,459 - __main__ - INFO - test_relevance_predictor: PASSED
2025-05-10 09:33:31,459 - __main__ - INFO - test_attention_statistics_extractor: PASSED
2025-05-10 09:33:31,460 - __main__ - INFO - test_handcrafted_feature_extractor: PASSED
2025-05-10 09:33:31,460 - __main__ - INFO - test_threshold_controller: PASSED
2025-05-10 09:33:31,460 - __main__ - INFO - test_kv_cache_factory: FAILED
2025-05-10 09:33:31,460 - __main__ - INFO - test_sparse_kv_cache: ERROR
2025-05-10 09:33:31,460 - __main__ - INFO - test_model_integration: FAILED
2025-05-10 09:33:31,460 - __main__ - ERROR - Some tests failed or had errors!
2025-05-10 09:33:55,450 - __main__ - INFO - Starting experiment with configuration: {'model_name': 'meta-llama/Llama-2-7b-hf', 'max_seq_len': 4096, 'use_fp16': False, 'methods': ['full', 'sliding_window', 'dynamic_kv', 'rocket_kv', 'atskv'], 'context_sizes': [512, 1024, 2048, 4096], 'output_dir': 'outputs', 'seed': 42, 'use_api': True, 'api_model': 'claude-3-7-sonnet-20250219'}
2025-05-10 09:33:55,451 - __main__ - INFO - Using device: cuda
2025-05-10 09:33:55,451 - __main__ - INFO - Using API-based model: claude-3-7-sonnet-20250219
2025-05-10 09:33:59,685 - evaluation - INFO - All plots saved to outputs/results
2025-05-10 09:33:59,685 - __main__ - INFO - Experiment completed in 4.23 seconds
2025-05-10 09:33:59,685 - __main__ - INFO - Results saved to outputs/results
