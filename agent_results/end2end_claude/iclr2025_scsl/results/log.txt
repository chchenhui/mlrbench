2025-05-10 16:26:35,035 - run_experiments - INFO - Starting experiments at 2025-05-10 16:26:35.035235
2025-05-10 16:26:35,035 - run_experiments - INFO - Running experiment with model=cimrl, config=configs/default.json, seed=42
2025-05-10 16:26:35,036 - main - INFO - Using device: cuda
2025-05-10 16:26:35,073 - main - INFO - Using GPU: NVIDIA GeForce RTX 3090
2025-05-10 16:26:35,073 - main - INFO - Number of GPUs available: 4
2025-05-10 16:26:40,191 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-05-10 16:27:11,069 - main - INFO - Initialized CIMRL model with 198,110,473 trainable parameters
2025-05-10 16:27:11,071 - main - INFO - Starting training at 2025-05-10 16:27:11.071512
2025-05-10 16:29:13,140 - demo - INFO - Using device: cuda
2025-05-10 16:29:13,141 - demo - INFO - Generating synthetic data...
2025-05-10 16:29:13,165 - demo - INFO - Training CIMRL model...
2025-05-10 16:29:14,677 - demo - INFO - Epoch 1/30 - Train loss: 0.4940, Train acc: 0.7752, Val loss: 0.2380, Val acc: 0.9800
2025-05-10 16:29:14,888 - demo - INFO - Epoch 2/30 - Train loss: 0.1539, Train acc: 0.9728, Val loss: 0.0775, Val acc: 0.9920
2025-05-10 16:29:15,097 - demo - INFO - Epoch 3/30 - Train loss: 0.0587, Train acc: 0.9940, Val loss: 0.0374, Val acc: 0.9960
2025-05-10 16:29:15,306 - demo - INFO - Epoch 4/30 - Train loss: 0.0296, Train acc: 0.9980, Val loss: 0.0207, Val acc: 0.9960
2025-05-10 16:29:15,516 - demo - INFO - Epoch 5/30 - Train loss: 0.0178, Train acc: 0.9990, Val loss: 0.0151, Val acc: 0.9960
2025-05-10 16:29:15,729 - demo - INFO - Epoch 6/30 - Train loss: 0.0117, Train acc: 0.9990, Val loss: 0.0123, Val acc: 0.9960
2025-05-10 16:29:15,940 - demo - INFO - Epoch 7/30 - Train loss: 0.0079, Train acc: 1.0000, Val loss: 0.0138, Val acc: 0.9960
2025-05-10 16:29:16,148 - demo - INFO - Epoch 8/30 - Train loss: 0.0060, Train acc: 1.0000, Val loss: 0.0099, Val acc: 0.9960
2025-05-10 16:29:16,358 - demo - INFO - Epoch 9/30 - Train loss: 0.0044, Train acc: 1.0000, Val loss: 0.0100, Val acc: 0.9960
2025-05-10 16:29:16,567 - demo - INFO - Epoch 10/30 - Train loss: 0.0036, Train acc: 1.0000, Val loss: 0.0087, Val acc: 0.9960
2025-05-10 16:29:16,780 - demo - INFO - Epoch 11/30 - Train loss: 0.0029, Train acc: 1.0000, Val loss: 0.0088, Val acc: 0.9960
2025-05-10 16:29:16,989 - demo - INFO - Epoch 12/30 - Train loss: 0.0024, Train acc: 1.0000, Val loss: 0.0075, Val acc: 0.9960
2025-05-10 16:29:17,198 - demo - INFO - Epoch 13/30 - Train loss: 0.0020, Train acc: 1.0000, Val loss: 0.0066, Val acc: 0.9960
2025-05-10 16:29:17,407 - demo - INFO - Epoch 14/30 - Train loss: 0.0017, Train acc: 1.0000, Val loss: 0.0074, Val acc: 0.9960
2025-05-10 16:29:17,616 - demo - INFO - Epoch 15/30 - Train loss: 0.0015, Train acc: 1.0000, Val loss: 0.0070, Val acc: 0.9960
2025-05-10 16:29:17,826 - demo - INFO - Epoch 16/30 - Train loss: 0.0013, Train acc: 1.0000, Val loss: 0.0069, Val acc: 0.9960
2025-05-10 16:29:18,037 - demo - INFO - Epoch 17/30 - Train loss: 0.0011, Train acc: 1.0000, Val loss: 0.0067, Val acc: 0.9960
2025-05-10 16:29:18,247 - demo - INFO - Epoch 18/30 - Train loss: 0.0010, Train acc: 1.0000, Val loss: 0.0067, Val acc: 0.9960
2025-05-10 16:29:18,456 - demo - INFO - Epoch 19/30 - Train loss: 0.0009, Train acc: 1.0000, Val loss: 0.0065, Val acc: 0.9960
2025-05-10 16:29:18,664 - demo - INFO - Epoch 20/30 - Train loss: 0.0008, Train acc: 1.0000, Val loss: 0.0064, Val acc: 0.9960
2025-05-10 16:29:18,873 - demo - INFO - Epoch 21/30 - Train loss: 0.0007, Train acc: 1.0000, Val loss: 0.0061, Val acc: 0.9960
2025-05-10 16:29:19,083 - demo - INFO - Epoch 22/30 - Train loss: 0.0006, Train acc: 1.0000, Val loss: 0.0062, Val acc: 0.9960
2025-05-10 16:29:19,296 - demo - INFO - Epoch 23/30 - Train loss: 0.0006, Train acc: 1.0000, Val loss: 0.0060, Val acc: 0.9960
2025-05-10 16:29:19,504 - demo - INFO - Epoch 24/30 - Train loss: 0.0005, Train acc: 1.0000, Val loss: 0.0062, Val acc: 0.9960
2025-05-10 16:29:19,712 - demo - INFO - Epoch 25/30 - Train loss: 0.0005, Train acc: 1.0000, Val loss: 0.0059, Val acc: 0.9960
2025-05-10 16:29:19,922 - demo - INFO - Epoch 26/30 - Train loss: 0.0004, Train acc: 1.0000, Val loss: 0.0059, Val acc: 0.9960
2025-05-10 16:29:20,131 - demo - INFO - Epoch 27/30 - Train loss: 0.0004, Train acc: 1.0000, Val loss: 0.0059, Val acc: 0.9960
2025-05-10 16:29:20,339 - demo - INFO - Epoch 28/30 - Train loss: 0.0004, Train acc: 1.0000, Val loss: 0.0059, Val acc: 0.9960
2025-05-10 16:29:20,548 - demo - INFO - Epoch 29/30 - Train loss: 0.0003, Train acc: 1.0000, Val loss: 0.0060, Val acc: 0.9960
2025-05-10 16:29:20,758 - demo - INFO - Epoch 30/30 - Train loss: 0.0003, Train acc: 1.0000, Val loss: 0.0061, Val acc: 0.9960
2025-05-10 16:29:21,429 - demo - INFO - Evaluating CIMRL model...
2025-05-10 16:29:21,471 - demo - INFO - CIMRL model test accuracy: 1.0000
2025-05-10 16:29:21,471 - demo - INFO - CIMRL model test worst-group accuracy: 1.0000
2025-05-10 16:29:21,471 - demo - INFO - CIMRL model OOD test accuracy: 0.9880
2025-05-10 16:29:21,471 - demo - INFO - CIMRL model OOD test worst-group accuracy: 0.9829
2025-05-10 16:29:21,471 - demo - INFO - Training Baseline model...
2025-05-10 16:29:21,598 - demo - INFO - Epoch 1/30 - Train loss: 0.5051, Train acc: 0.8518, Val loss: 0.2872, Val acc: 0.9960
2025-05-10 16:29:21,745 - demo - INFO - Epoch 2/30 - Train loss: 0.2177, Train acc: 0.9879, Val loss: 0.1573, Val acc: 1.0000
2025-05-10 16:29:21,892 - demo - INFO - Epoch 3/30 - Train loss: 0.1390, Train acc: 0.9940, Val loss: 0.1116, Val acc: 0.9960
2025-05-10 16:29:22,041 - demo - INFO - Epoch 4/30 - Train loss: 0.1027, Train acc: 0.9950, Val loss: 0.0846, Val acc: 0.9960
2025-05-10 16:29:22,188 - demo - INFO - Epoch 5/30 - Train loss: 0.0778, Train acc: 0.9970, Val loss: 0.0666, Val acc: 0.9960
2025-05-10 16:29:22,335 - demo - INFO - Epoch 6/30 - Train loss: 0.0606, Train acc: 0.9980, Val loss: 0.0524, Val acc: 0.9960
2025-05-10 16:29:22,483 - demo - INFO - Epoch 7/30 - Train loss: 0.0484, Train acc: 0.9990, Val loss: 0.0428, Val acc: 0.9960
2025-05-10 16:29:22,629 - demo - INFO - Epoch 8/30 - Train loss: 0.0385, Train acc: 1.0000, Val loss: 0.0370, Val acc: 0.9960
2025-05-10 16:29:22,775 - demo - INFO - Epoch 9/30 - Train loss: 0.0316, Train acc: 1.0000, Val loss: 0.0317, Val acc: 0.9960
2025-05-10 16:29:22,922 - demo - INFO - Epoch 10/30 - Train loss: 0.0265, Train acc: 1.0000, Val loss: 0.0260, Val acc: 0.9960
2025-05-10 16:29:23,068 - demo - INFO - Epoch 11/30 - Train loss: 0.0221, Train acc: 1.0000, Val loss: 0.0229, Val acc: 0.9960
2025-05-10 16:29:23,215 - demo - INFO - Epoch 12/30 - Train loss: 0.0188, Train acc: 1.0000, Val loss: 0.0188, Val acc: 1.0000
2025-05-10 16:29:23,362 - demo - INFO - Epoch 13/30 - Train loss: 0.0163, Train acc: 1.0000, Val loss: 0.0184, Val acc: 0.9960
2025-05-10 16:29:23,512 - demo - INFO - Epoch 14/30 - Train loss: 0.0141, Train acc: 1.0000, Val loss: 0.0156, Val acc: 0.9960
2025-05-10 16:29:23,660 - demo - INFO - Epoch 15/30 - Train loss: 0.0123, Train acc: 1.0000, Val loss: 0.0143, Val acc: 0.9960
2025-05-10 16:29:23,807 - demo - INFO - Epoch 16/30 - Train loss: 0.0108, Train acc: 1.0000, Val loss: 0.0132, Val acc: 0.9960
2025-05-10 16:29:23,954 - demo - INFO - Epoch 17/30 - Train loss: 0.0096, Train acc: 1.0000, Val loss: 0.0115, Val acc: 1.0000
2025-05-10 16:29:24,101 - demo - INFO - Epoch 18/30 - Train loss: 0.0085, Train acc: 1.0000, Val loss: 0.0109, Val acc: 0.9960
2025-05-10 16:29:24,247 - demo - INFO - Epoch 19/30 - Train loss: 0.0077, Train acc: 1.0000, Val loss: 0.0102, Val acc: 0.9960
2025-05-10 16:29:24,394 - demo - INFO - Epoch 20/30 - Train loss: 0.0069, Train acc: 1.0000, Val loss: 0.0094, Val acc: 0.9960
2025-05-10 16:29:24,542 - demo - INFO - Epoch 21/30 - Train loss: 0.0063, Train acc: 1.0000, Val loss: 0.0092, Val acc: 0.9960
2025-05-10 16:29:24,689 - demo - INFO - Epoch 22/30 - Train loss: 0.0057, Train acc: 1.0000, Val loss: 0.0085, Val acc: 0.9960
2025-05-10 16:29:24,836 - demo - INFO - Epoch 23/30 - Train loss: 0.0052, Train acc: 1.0000, Val loss: 0.0078, Val acc: 0.9960
2025-05-10 16:29:24,985 - demo - INFO - Epoch 24/30 - Train loss: 0.0048, Train acc: 1.0000, Val loss: 0.0077, Val acc: 0.9960
2025-05-10 16:29:25,132 - demo - INFO - Epoch 25/30 - Train loss: 0.0044, Train acc: 1.0000, Val loss: 0.0071, Val acc: 0.9960
2025-05-10 16:29:25,279 - demo - INFO - Epoch 26/30 - Train loss: 0.0040, Train acc: 1.0000, Val loss: 0.0069, Val acc: 0.9960
2025-05-10 16:29:25,426 - demo - INFO - Epoch 27/30 - Train loss: 0.0038, Train acc: 1.0000, Val loss: 0.0068, Val acc: 0.9960
2025-05-10 16:29:25,573 - demo - INFO - Epoch 28/30 - Train loss: 0.0035, Train acc: 1.0000, Val loss: 0.0062, Val acc: 0.9960
2025-05-10 16:29:25,719 - demo - INFO - Epoch 29/30 - Train loss: 0.0032, Train acc: 1.0000, Val loss: 0.0062, Val acc: 0.9960
2025-05-10 16:29:25,865 - demo - INFO - Epoch 30/30 - Train loss: 0.0030, Train acc: 1.0000, Val loss: 0.0060, Val acc: 0.9960
2025-05-10 16:29:26,423 - demo - INFO - Evaluating Baseline model...
2025-05-10 16:29:26,426 - demo - INFO - Baseline model test accuracy: 1.0000
2025-05-10 16:29:26,427 - demo - INFO - Baseline model test worst-group accuracy: 1.0000
2025-05-10 16:29:26,427 - demo - INFO - Baseline model OOD test accuracy: 0.9920
2025-05-10 16:29:26,427 - demo - INFO - Baseline model OOD test worst-group accuracy: 0.9911
2025-05-10 16:29:26,427 - demo - INFO - Generating comparison plots...
2025-05-10 16:29:27,408 - demo - INFO - Demo completed successfully!
